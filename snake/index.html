<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Clássico</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #2c3e50;
            --container-bg: #34495e;
            --canvas-bg: #1c2833;
            --snake-head: #2ecc71;
            --snake-body: #27ae60;
            --apple-color: #e74c3c;
            --super-coin-color: #f1c40f;
            --text-color: #ecf0f1;
            --button-bg: #e67e22;
            --button-hover: #d35400;
        }

        body {
            font-family: 'VT323', monospace;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            flex-direction: column;
            gap: 20px;
        }

        .game-container {
            background-color: var(--container-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            border: 2px solid var(--text-color);
        }

        h1 {
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        canvas {
            background-color: var(--canvas-bg);
            border: 2px solid var(--text-color);
            border-radius: 5px;
            margin-top: 20px;
        }

        #score-board {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 10px;
            font-size: 1.5em;
        }
        
        #score-board span {
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        button {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.1s;
        }

        button:hover {
            background-color: var(--button-hover);
        }
        
        button:active {
            transform: scale(0.98);
        }

        .dpad {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            grid-template-rows: repeat(3, 60px);
            gap: 5px;
            margin-top: 15px;
        }

        .dpad button {
            background-color: var(--container-bg);
            color: var(--text-color);
            font-size: 1.5em;
            border: 1px solid var(--text-color);
        }
        .dpad button:active {
            transform: scale(0.95);
        }
        .dpad button[data-dir="up"] { grid-column: 2; grid-row: 1; }
        .dpad button[data-dir="left"] { grid-column: 1; grid-row: 2; }
        .dpad button[data-dir="right"] { grid-column: 3; grid-row: 2; }
        .dpad button[data-dir="down"] { grid-column: 2; grid-row: 3; }

        @media (max-width: 600px) {
            .game-container { padding: 20px; }
            h1 { font-size: 2.5em; }
            .dpad { display: grid; }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>SNAKE CLÁSSICO</h1>
        
        <div id="score-board">
            <span>Pontos: <span id="score">0</span></span>
            <span>Recorde: <span id="best">0</span></span>
        </div>

        <canvas id="snakeCanvas" width="480" height="480"></canvas>

        <div class="controls">
            <div id="bonus-display" style="color: gold; font-weight: bold; font-size: 1.5em;"></div>
            <div class="btn-group">
                <button id="btnPause">Pausar</button>
                <button id="btnRestart">Reiniciar</button>
            </div>
            
            <div class="dpad" id="dpad-mobile">
                <div></div><button data-dir="up">▲</button><div></div>
                <button data-dir="left">◄</button><div></div><button data-dir="right">►</button>
                <div></div><button data-dir="down">▼</button><div></div>
            </div>
        </div>
    </div>

<script>
    (function() {
        // Configurações do jogo
        const canvas = document.getElementById('snakeCanvas');
        const ctx = canvas.getContext('2d');
        const tileSize = 20;
        const gridSize = canvas.width / tileSize;

        let snake = [{ x: 10, y: 10 }];
        let food = {};
        let direction = 'right';
        let score = 0;
        let speed = 150;
        let gameLoop;
        let isPaused = false;
        let bestScore = localStorage.getItem('snakeBestScore') || 0;

        // Bônus
        let bonus = null;
        let bonusTimer = 0;
        const BONUS_DURATION = 3000;
        const BONUS_INTERVAL = 20000;
        const BONUS_TIMEOUT = 5000;

        // Elementos do DOM
        const scoreEl = document.getElementById('score');
        const bestEl = document.getElementById('best');
        const bonusDisplay = document.getElementById('bonus-display');
        const btnPause = document.getElementById('btnPause');
        const btnRestart = document.getElementById('btnRestart');
        const dpadButtons = document.querySelectorAll('#dpad-mobile button');

        bestEl.textContent = bestScore;

        function getRandomPosition() {
            let pos;
            do {
                pos = {
                    x: Math.floor(Math.random() * gridSize),
                    y: Math.floor(Math.random() * gridSize)
                };
            } while (snake.some(segment => segment.x === pos.x && segment.y === pos.y));
            return pos;
        }

        function createFood() {
            food = getRandomPosition();
        }

        function createBonus() {
            bonus = getRandomPosition();
            bonusTimer = Date.now();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Desenhar a comida (maçã vermelha)
            ctx.fillStyle = 'var(--apple-color)';
            ctx.fillRect(food.x * tileSize, food.y * tileSize, tileSize, tileSize);

            // Desenhar a cobra (quadrados verdes)
            snake.forEach((segment, index) => {
                ctx.fillStyle = (index === 0) ? 'var(--snake-head)' : 'var(--snake-body)';
                ctx.fillRect(segment.x * tileSize, segment.y * tileSize, tileSize, tileSize);
                ctx.strokeStyle = '#000';
                ctx.strokeRect(segment.x * tileSize, segment.y * tileSize, tileSize, tileSize);
            });

            // Desenhar o bônus (quadrado amarelo)
            if (bonus) {
                if (Date.now() - bonusTimer > BONUS_TIMEOUT) {
                    bonus = null;
                } else {
                    ctx.fillStyle = 'var(--super-coin-color)';
                    ctx.fillRect(bonus.x * tileSize, bonus.y * tileSize, tileSize, tileSize);
                    ctx.strokeStyle = 'rgba(0,0,0,0.5)';
                    ctx.strokeRect(bonus.x * tileSize, bonus.y * tileSize, tileSize, tileSize);
                }
            }

            // Atualizar o placar
            scoreEl.textContent = score;
            bonusDisplay.textContent = (Date.now() - bonusTimer < BONUS_DURATION) ? 'Pontos x2' : '';
        }

        function update() {
            if (isPaused) return;

            const head = { x: snake[0].x, y: snake[0].y };

            switch (direction) {
                case 'right': head.x++; break;
                case 'left': head.x--; break;
                case 'up': head.y--; break;
                case 'down': head.y++; break;
            }

            // Colisão com as paredes (teletransporte)
            if (head.x < 0) head.x = gridSize - 1;
            if (head.x >= gridSize) head.x = 0;
            if (head.y < 0) head.y = gridSize - 1;
            if (head.y >= gridSize) head.y = 0;

            // Colisão com o corpo
            if (checkCollision(head)) {
                gameOver();
                return;
            }

            snake.unshift(head);

            // Comer a comida
            if (head.x === food.x && head.y === food.y) {
                score += (Date.now() - bonusTimer < BONUS_DURATION) ? 2 : 1;
                createFood();
                increaseSpeed();
            } else {
                snake.pop();
            }

            // Comer o bônus
            if (bonus && head.x === bonus.x && head.y === bonus.y) {
                score += 5;
                bonus = null;
                bonusTimer = Date.now();
            }

            draw();
        }

        function checkCollision(head) {
            return snake.slice(1).some(segment => segment.x === head.x && segment.y === head.y);
        }

        function increaseSpeed() {
            speed = Math.max(75, speed - 1);
            clearInterval(gameLoop);
            gameLoop = setInterval(update, speed);
        }

        function gameOver() {
            clearInterval(gameLoop);
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'white';
            ctx.font = '50px "VT323"';
            ctx.textAlign = 'center';
            ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2 - 25);
            ctx.font = '25px "VT323"';
            ctx.fillText('Clique em Reiniciar', canvas.width / 2, canvas.height / 2 + 10);
            
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('snakeBestScore', bestScore);
                bestEl.textContent = bestScore;
            }
        }

        function restartGame() {
            clearInterval(gameLoop);
            snake = [{ x: 10, y: 10 }];
            direction = 'right';
            score = 0;
            speed = 150;
            isPaused = false;
            bonus = null;
            btnPause.textContent = 'Pausar';
            createFood();
            startGame();
        }

        function togglePause() {
            isPaused = !isPaused;
            btnPause.textContent = isPaused ? 'Retomar' : 'Pausar';
        }

        function startGame() {
            gameLoop = setInterval(update, speed);
            setInterval(createBonus, BONUS_INTERVAL);
        }
        
        // Eventos de teclado
        window.addEventListener('keydown', e => {
            const key = e.key.toLowerCase();
            if (key === 'w' && direction !== 'down') direction = 'up';
            if (key === 's' && direction !== 'up') direction = 'down';
            if (key === 'a' && direction !== 'right') direction = 'left';
            if (key === 'd' && direction !== 'left') direction = 'right';
            if (key === 'p' || key === 'escape') togglePause();
        });

        // Eventos dos botões
        btnPause.addEventListener('click', togglePause);
        btnRestart.addEventListener('click', restartGame);

        // Eventos do D-pad (mobile)
        dpadButtons.forEach(button => {
            button.addEventListener('click', () => {
                const dir = button.getAttribute('data-dir');
                if (dir === 'up' && direction !== 'down') direction = 'up';
                if (dir === 'down' && direction !== 'up') direction = 'down';
                if (dir === 'left' && direction !== 'right') direction = 'left';
                if (dir === 'right' && direction !== 'left') direction = 'right';
            });
        });

        // Inicia o jogo
        createFood();
        startGame();
    })();
</script>

</body>
</html>
